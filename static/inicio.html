<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P√°gina Inicial - Chatbot</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            line-height: 1.6;
            transition: background 0.3s, color 0.3s;
        }

        .container {
            max-width: 1100px;
            margin: auto;
            overflow: hidden;
            padding: 0 20px;
        }

        header {
            background: #4dcfe1;
            color: #fff;
            padding: 1rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header h1 {
            margin: 0;
            font-size: 24px;
        }

        header nav ul {
            padding: 0;
            margin: 0;
            list-style: none;
        }

        header nav ul li {
            display: inline;
            margin-left: 20px;
        }

        header nav a {
            color: #fff;
            text-decoration: none;
            font-weight: bold;
        }

        .theme-toggle {
            cursor: pointer;
            background: #fff;
            color: #4dcfe1;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            font-weight: bold;
            transition: background 0.3s, color 0.3s;
        }

        .hero {
            background: #fff;
            text-align: center;
            padding: 60px 20px;
            border-bottom: 1px solid #ddd;
        }

        .hero h2 {
            font-size: 48px;
            margin-bottom: 20px;
            color: #333;
        }

        .hero p {
            font-size: 18px;
            max-width: 600px;
            margin: 0 auto 30px auto;
        }

        .cta-button {
            display: inline-block;
            background: black;
            color: #fff;
            padding: 15px 30px;
            text-decoration: none;
            border-radius: 5px;
            font-size: 18px;
            transition: background-color 0.3s ease;
        }

        .level-display {
            background-color: #e0f7fa;
            color: #00796b;
            padding: 10px 20px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 30px;
        }

        .cta-button:hover {
            background-color: #466265;
        }

        .features {
            padding: 40px 20px;
            text-align: center;
        }

        .features h3 {
            font-size: 32px;
            margin-bottom: 40px;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .feature-item {
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0,0,0,0.05);
        }

        .feature-item h4 {
            font-size: 20px;
            margin-top: 0;
        }

        footer {
            text-align: center;
            padding: 20px;
            background: #333;
            color: #fff;
            margin-top: 40px;
        }

        .feature-item a {
            color: #4dcfe1;
            text-decoration: none;
            font-weight: bold;
        }

        /* ======== DARK MODE ======== */
        body.dark-mode {
            background-color: #121212;
            color: #e4e4e4;
        }

        body.dark-mode header {
            background: #222;
        }

        body.dark-mode .hero {
            background: #1e1e1e;
            border-bottom: 1px solid #444;
        }

        body.dark-mode .hero h2 {
            color: #e4e4e4;
        }

        body.dark-mode .feature-item {
            background: #1e1e1e;
            box-shadow: 0 0 10px rgba(255,255,255,0.05);
        }

        body.dark-mode footer {
            background: #111;
        }

        body.dark-mode .theme-toggle {
            background: #4dcfe1;
            color: #fff;
        }

        /* Estilos do menu de usu√°rio */
        li.user-menu { position: relative; display: inline-block; } /* Aumenta a especificidade */
        .user-menu-btn {
            background: none; border: none; cursor: pointer; font-size: 1rem;
            display: flex; align-items: center; color: inherit; font-weight: bold;
        }
        .user-menu-btn img { width: 30px; height: 30px; border-radius: 50%; margin-right: 8px; }
        .dropdown-content { display: none; position: absolute; right: 0; background-color: #fff;
            min-width: 160px; box-shadow: 0px 8px 16px rgba(0,0,0,0.2); z-index: 1; border-radius: 5px; }
        body.dark-mode .dropdown-content { background-color: #2c2c2c; }
        .dropdown-content a { color: black !important; padding: 12px 16px; text-decoration: none; display: block; }
        body.dark-mode .dropdown-content a { color: #e0e0e0 !important; }
        .dropdown-content a:hover { background-color: #f1f1f1; }
        body.dark-mode .dropdown-content a:hover { background-color: #383838; }
        .user-menu:hover .dropdown-content { display: block; }
        
        body.dark-mode .level-display {
            background-color: #004d40;
            color: #b2dfdb;
        }

        /* Bot√£o plataforma no menu */
        .study-btn {
            background: #fff;
            color: #4dcfe1 !important;
            padding: 6px 14px;
            border-radius: 6px;
            font-weight: bold;
            transition: background 0.3s, color 0.3s;
        }

        .study-btn:hover {
            background: #36a9b0;
            color: #fff !important;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>LabTech</h1>
            <nav>
                <ul>
                    <li><a href="/aprendizado.html" class="study-btn">Plataforma de Estudo</a></li> 
                    <li class="user-menu">
                        <button class="user-menu-btn">
                            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iZ3JheSIgd2lkdGg9IjMwcHgiIGhlaWdodD0iMzBweCI+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik0xMiAxMi4yNWMxLjIzIDAgMi4yNS0xLjAyIDIuMjUtMi4yNVMxMy4yMyA3LjcgMTIgNy43IDEwLjI1IDguMiAxMC4yNSA5czEuMDIgMi4yNSAyLjI1IDIuMjV6bTAtMmMtMi42NyAwLTggMS4zNC04IDR2MmgxNnYtMmMwLTIuNjYtNS4zMy00LTgtNHoiLz48L3N2Zz4=" alt="User Avatar">
                            <span>Carregando...</span> &#9662;
                        </button>
                        <div class="dropdown-content">
                            <a href="/perfil.html">Meu Perfil</a>
                            <a href="/logout">Sair</a>
                        </div>
                    </li>
                    <li><button class="theme-toggle" onclick="toggleTheme()">üåô Modo Escuro</button></li> 
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="hero">
            <h2>Converse com o Futuro</h2>
            <p>Nosso chatbot inteligente est√° pronto para ajudar voc√™ com respostas r√°pidas e precisas, 24 horas por dia.</p>
            <div id="level-container" style="display: none;"><span class="level-display">Seu n√≠vel: <b id="student-level"></b></span></div>
            <a href="/index.html" class="cta-button">Come√ßar a Conversar</a>
        </section>

        <section class="features">
            <div class="container">
                <h3>Funcionalidades Principais</h3>
                <div class="features-grid">
                    <div class="feature-item">
                        <h4>Disponibilidade 24/7</h4>
                        <p>Acesse a qualquer hora, de qualquer lugar. Estamos sempre online para voc√™.</p>
                    </div>
                    <div class="feature-item">
                        <h4>Respostas Instant√¢neas</h4>
                        <p>Obtenha as informa√ß√µes que precisa sem espera. R√°pido e eficiente.</p>
                    </div>
                    <div class="feature-item">
                        <h4>F√°cil de Usar</h4>
                        <p>Uma interface amig√°vel e intuitiva para uma experi√™ncia de conversa natural.</p>
                    </div>
                    <!-- üö´ Card da Plataforma Educacional removido -->
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Meu Chatbot. Todos os direitos reservados.</p>
    </footer>

    <script>
        function toggleTheme() {
            const body = document.body;
            const button = document.querySelector(".theme-toggle");
            body.classList.toggle("dark-mode");

            if (body.classList.contains("dark-mode")) {
                button.textContent = "‚òÄÔ∏è Modo Claro";
                localStorage.setItem("theme", "dark");
            } else {
                button.textContent = "üåô Modo Escuro";
                localStorage.setItem("theme", "light");
            }
        }

        // Carregar tema salvo
        document.addEventListener("DOMContentLoaded", () => {
            const savedTheme = localStorage.getItem("theme");
            if (savedTheme === "dark") {
                document.body.classList.add("dark-mode");
                document.querySelector(".theme-toggle").textContent = "‚òÄÔ∏è Modo Claro";
            }

            // Buscar dados do usu√°rio e exibir o n√≠vel
            fetchUserData();
        });

        async function fetchUserData() {
            try {
                const response = await fetch('/api/me');
                if (!response.ok) {
                    // Se n√£o estiver logado, redireciona para o login
                    if (response.status === 401) window.location.href = '/login.html';
                    return;
                }
                const user = await response.json();

                // Atualiza o nome do usu√°rio no menu
                const userNameSpan = document.querySelector(".user-menu-btn span");
                if (userNameSpan) userNameSpan.textContent = user.fullname;

                // Calcula e exibe o n√≠vel se o quiz foi completado
                if (user.quizCompleted && user.score !== null) {
                    const level = getStudentLevel(user.score);
                    document.getElementById('student-level').textContent = level;
                    document.getElementById('level-container').style.display = 'block';
                }

            } catch (error) {
                console.error("Erro ao buscar dados do usu√°rio:", error);
            }
        }

        function getStudentLevel(score) {
            if (score <= 5) return "Iniciante";
            if (score <= 10) return "B√°sico";
            if (score <= 15) return "Intermedi√°rio";
            if (score <= 20) return "Avan√ßado";
            return "N√£o definido";
        }
    </script>
</body>
</html>
